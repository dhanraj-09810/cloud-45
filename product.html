<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Cloud-45 - Order</title> <link rel="stylesheet" href="styles.css">
    <style>
        /* Add specific styles for the feedback sections */
        .product-feedback-container {
            display: flex;
            flex-wrap: wrap; /* Allows stacking on small screens */
            gap: 20px;
            margin-top: 1.5rem;
            border-top: 1px solid #eee;
            padding-top: 1.5rem;
        }

        .feedback-form-area,
        .feedback-display-area {
            flex: 1;
            min-width: 280px; /* Adjusted min-width for better mobile display */
            background-color: #f9f9f9;
            padding: 1rem;
            border-radius: var(--border-radius);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            box-sizing: border-box; /* Essential for responsive sizing */
        }

        .feedback-display-area ul {
            list-style: none; /* Remove bullet points */
            padding-left: 0;
        }

        .feedback-display-area ul li {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #ddd;
        }
        .feedback-display-area ul li:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .order-section {
            padding: 2rem; /* Adjusted padding for better mobile fit */
            max-width: 1000px; /* Max width for the whole order section */
            margin: 2rem auto; /* Center the section */
            box-sizing: border-box;
            width: calc(100% - 2rem); /* Ensure consistent margin on edges */
        }

        .order-section h1 {
            text-align: center;
            margin-bottom: 2rem;
            font-size: clamp(2.2rem, 5vw, 3rem); /* Responsive font size */
        }

        .order-section fieldset {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            background-color: #fff;
            box-sizing: border-box; /* Ensure padding is included in width */
        }

        .order-section legend {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--color-primary);
            padding: 0 10px;
            width: auto; /* Allow legend to size itself */
            margin-bottom: 1rem; /* Space below legend */
        }

        .order-section label {
            display: block; /* Make labels block for better stacking on small screens */
            margin-bottom: 0.75rem; /* Space between labels */
            font-weight: 500;
        }
        .order-section label input[type="radio"],
        .order-section label input[type="checkbox"] {
            margin-right: 0.5rem; /* Space for radio/checkbox */
            vertical-align: middle; /* Align with text */
        }


        .order-section input[type="number"],
        .order-section select,
        .order-section textarea {
            display: block; /* Make inputs block for full width */
            width: 100%; /* Make them fill their container */
            padding: 0.75rem; /* Increased padding for touch targets */
            border: 1px solid #ccc;
            border-radius: 5px;
            font-family: var(--font-family);
            font-size: 1em;
            margin-top: 5px; /* Space below label */
            box-sizing: border-box; /* Crucial for full width */
        }

        .order-section textarea {
            resize: vertical; /* Allow vertical resizing */
            min-height: 80px; /* Minimum height for text area */
        }
        .order-section .btn {
            margin-top: 1rem;
            width: auto; /* Allow button to size itself */
            display: inline-block; /* Keep btn styles */
        }

        /* Adjust button placement for calculation and redirection */
        .order-action-buttons {
            display: flex;
            flex-direction: column; /* Stack buttons on mobile */
            gap: 1rem;
            margin-top: 2rem;
            padding: 0 1rem; /* Add horizontal padding to buttons container */
        }
        .order-action-buttons .btn {
            flex: 1;
            text-align: center;
            width: 100%; /* Full width for stacked buttons */
        }

        /* Responsive adjustments for the order section */
        @media (max-width: 768px) {
            .order-section {
                padding: 1.5rem;
                margin: 1.5rem auto;
                width: calc(100% - 1.5rem);
            }
            .order-section legend {
                font-size: 1.3rem;
            }
            .feedback-form-area,
            .feedback-display-area {
                min-width: unset; /* Remove min-width on very small screens */
                width: 100%; /* Make them take full width when stacked */
            }
        }
        @media (max-width: 480px) {
            .order-section {
                padding: 1rem;
                margin: 1rem auto;
                width: calc(100% - 1rem);
            }
            .order-section legend {
                font-size: 1.2rem;
            }
            .product-feedback-container {
                flex-direction: column; /* Ensure feedback areas stack */
            }
            .order-action-buttons {
                padding: 0; /* Remove padding from buttons container on smallest screens */
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

    <nav class="navbar">
        <div class="logo">
            <a href="index.html"><img src="image/image/upperlo.png" alt="Cloud-45 Logo" /></a>
        </div>
        <button class="menu-toggle" aria-label="Toggle navigation">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <ul class="navbar-nav"> <li><a href="index.html">Home</a></li>
            <li><a href="product.html" class="active">Products</a></li> <li><a href="about.html">About Us</a></li>
            <li><a href="order.html">Order</a></li>
        </ul>
    </nav>

    <section class="order-section">
        <h1>Place Your Order</h1>
        <form id="mainOrderForm" action="order-summary.html" method="get">
            <fieldset>
                <legend>Hookah</legend>
                <img src="image/image/R (1).png" alt="Hookah Image" class="product-image"><br/>
                <label>
                    Choose Flavour:
                    <select name="hookah_flavour" id="hookahFlavour">
                        <option value="None">None</option>
                        <option value="Mint">Mint (₹400)</option>
                        <option value="Apple">Apple (₹400)</option>
                        <option value="Pan">Pan (₹400)</option>
                        <option value="Orange">Orange (₹400)</option>
                        <option value="Grape">Grape (₹400)</option>
                    </select>
                </label><br><br>
                <label>
                    Extra Coal & Paper (+₹50):
                    <input type="checkbox" name="hookah_extra" id="hookahExtra">
                </label><br><br>
                <label>Extra Hours (After 3 hours) — ₹100/hour:
                    <input type="number" id="extraHookahHours" value="0" min="0" />
                </label>

                <div class="product-feedback-container">
                    <div class="feedback-form-area">
                        <h2 style="text-align:center;">Rate Hookah</h2>
                        <label for="hookahRating">Rating:</label>
                        <select id="hookahRating" name="hookah_rating">
                            <option value="">--Rate--</option>
                            <option value="5">⭐⭐⭐⭐⭐ (5)</option>
                            <option value="4">⭐⭐⭐⭐ (4)</option>
                            <option value="3">⭐⭐⭐ (3)</option>
                            <option value="2">⭐⭐ (2)</option>
                            <option value="1">⭐ (1)</option>
                        </select><br><br>
                        <label for="hookahComment">Your Feedback:</label><br>
                        <textarea id="hookahComment" name="hookah_comment" rows="3" placeholder="Write your comment here..."></textarea>
                        <br><br>
                        <button type="button" class="btn" onclick="submitFeedback('Hookah', 'hookahRating', 'hookahComment', 'hookahFeedbackDisplay')">Submit Feedback</button>
                    </div>
                    <div class="feedback-display-area">
                        <h3>Hookah Feedback</h3>
                        <ul id="hookahFeedbackDisplay"></ul>
                    </div>
                </div>
            </fieldset>

            <fieldset>
                <legend>Simple Momo</legend>
                <img src="image/image/Special Momo.png" alt="Simple Momo Image" class="product-image"><br/>
                <label>Quantity:
                    <input type="number" id="simpleMomoQty" value="0" min="0"/>
                </label><br><br>
                <label>
                    <input type="radio" name="simple_momo_size" value="half" id="simpleMomoHalf"> Half (₹60)
                </label>
                <label>
                    <input type="radio" name="simple_momo_size" value="full" id="simpleMomoFull"> Full (₹120)
                </label>

                <div class="product-feedback-container">
                    <div class="feedback-form-area">
                        <h2 style="text-align:center;">Rate Simple Momo</h2>
                        <label for="simpleMomoRating">Rating:</label>
                        <select id="simpleMomoRating" name="simple_momo_rating">
                            <option value="">--Rate--</option>
                            <option value="5">⭐⭐⭐⭐⭐ (5)</option>
                            <option value="4">⭐⭐⭐⭐ (4)</option>
                            <option value="3">⭐⭐⭐ (3)</option>
                            <option value="2">⭐⭐ (2)</option>
                            <option value="1">⭐ (1)</option>
                        </select><br><br>
                        <label for="simpleMomoComment">Your Feedback:</label><br>
                        <textarea id="simpleMomoComment" name="simple_momo_comment" rows="3" placeholder="Write your comment here..."></textarea>
                        <br><br>
                        <button type="button" class="btn" onclick="submitFeedback('Simple Momo', 'simpleMomoRating', 'simpleMomoComment', 'simpleMomoFeedbackDisplay')">Submit Feedback</button>
                    </div>
                    <div class="feedback-display-area">
                        <h3>Simple Momo Feedback</h3>
                        <ul id="simpleMomoFeedbackDisplay"></ul>
                    </div>
                </div>
            </fieldset>

            <fieldset>
                <legend>Jhol Momo</legend>
                <img src="image/image/Spicy Tomato Jhol Momo.png" alt="Jhol Momo Image" class="product-image"><br/>
                <label>Quantity:
                    <input type="number" id="jholMomoQty" value="0" min="0"/>
                </label><br><br>
                <label>
                    <input type="radio" name="jhol_momo_size" value="half" id="jholMomoHalf"> Half (₹99)
                </label>
                <label>
                    <input type="radio" name="jhol_momo_size" value="full" id="jholMomoFull"> Full (₹199)
                </label>

                <div class="product-feedback-container">
                    <div class="feedback-form-area">
                        <h2 style="text-align:center;">Rate Jhol Momo</h2>
                        <label for="jholMomoRating">Rating:</label>
                        <select id="jholMomoRating" name="jhol_momo_rating">
                            <option value="">--Rate--</option>
                            <option value="5">⭐⭐⭐⭐⭐ (5)</option>
                            <option value="4">⭐⭐⭐⭐ (4)</option>
                            <option value="3">⭐⭐⭐ (3)</option>
                            <option value="2">⭐⭐ (2)</option>
                            <option value="1">⭐ (1)</option>
                        </select><br><br>
                        <label for="jholMomoComment">Your Feedback:</label><br>
                        <textarea id="jholMomoComment" name="jhol_momo_comment" rows="3" placeholder="Write your comment here..."></textarea>
                        <br><br>
                        <button type="button" class="btn" onclick="submitFeedback('Jhol Momo', 'jholMomoRating', 'jholMomoComment', 'jholMomoFeedbackDisplay')">Submit Feedback</button>
                    </div>
                    <div class="feedback-display-area">
                        <h3>Jhol Momo Feedback</h3>
                        <ul id="jholMomoFeedbackDisplay"></ul>
                    </div>
                </div>
            </fieldset>

            <fieldset>
                <legend>Coffee</legend>
                <img src="image/image/english coffee with roasted beans.png" alt="English Coffee" class="product-image"><br/>
                <label>English Coffee (₹80):
                    <input type="number" id="englishCoffeeQty" value="0" min="0"/>
                </label><br><br>
                <img src="image/image/Plane coffee.png" alt="Plain Coffee" class="product-image"><br/>
                <label>Plain Coffee (₹80):
                    <input type="number" id="plainCoffeeQty" value="0" min="0"/>
                </label>

                <div class="product-feedback-container">
                    <div class="feedback-form-area">
                        <h2 style="text-align:center;">Rate Coffee</h2>
                        <label for="coffeeRating">Rating:</label>
                        <select id="coffeeRating" name="coffee_rating">
                            <option value="">--Rate--</option>
                            <option value="5">⭐⭐⭐⭐⭐ (5)</option>
                            <option value="4">⭐⭐⭐⭐ (4)</option>
                            <option value="3">⭐⭐⭐ (3)</option>
                            <option value="2">⭐⭐ (2)</option>
                            <option value="1">⭐ (1)</option>
                        </select><br><br>
                        <label for="coffeeComment">Your Feedback:</label><br>
                        <textarea id="coffeeComment" name="coffee_comment" rows="3" placeholder="Write your comment here..."></textarea>
                        <br><br>
                        <button type="button" class="btn" onclick="submitFeedback('Coffee', 'coffeeRating', 'coffeeComment', 'coffeeFeedbackDisplay')">Submit Feedback</button>
                    </div>
                    <div class="feedback-display-area">
                        <h3>Coffee Feedback</h3>
                        <ul id="coffeeFeedbackDisplay"></ul>
                    </div>
                </div>
            </fieldset>

            <fieldset>
                <legend>Noodles</legend>
                <img src="image/image/caumin.png" alt="Noodles" class="product-image"><br/>
                <label>Quantity:
                    <input type="number" id="noodlesQty" value="0" min="0"/>
                </label><br><br>
                <label>
                    <input type="radio" name="noodles_size" value="half" id="noodlesHalf"> Half (₹80)
                </label>
                <label>
                    <input type="radio" name="noodles_size" value="full" id="noodlesFull"> Full (₹150)
                </label>

                <div class="product-feedback-container">
                    <div class="feedback-form-area">
                        <h2 style="text-align:center;">Rate Noodles</h2>
                        <label for="noodlesRating">Rating:</label>
                        <select id="noodlesRating" name="noodles_rating">
                            <option value="">--Rate--</option>
                            <option value="5">⭐⭐⭐⭐⭐ (5)</option>
                            <option value="4">⭐⭐⭐⭐ (4)</option>
                            <option value="3">⭐⭐⭐ (3)</option>
                            <option value="2">⭐⭐ (2)</option>
                            <option value="1">⭐ (1)</option>
                        </select><br><br>
                        <label for="noodlesComment">Your Feedback:</label><br>
                        <textarea id="noodlesComment" name="noodles_comment" rows="3" placeholder="Write your comment here..."></textarea>
                        <br><br>
                        <button type="button" class="btn" onclick="submitFeedback('Noodles', 'noodlesRating', 'noodlesComment', 'noodlesFeedbackDisplay')">Submit Feedback</button>
                    </div>
                    <div class="feedback-display-area">
                        <h3>Noodles Feedback</h3>
                        <ul id="noodlesFeedbackDisplay"></ul>
                    </div>
                </div>
            </fieldset>

            <fieldset>
                <legend>Tea</legend>
                <img src="image/image/tea.png" alt="Normal Chai image" class="product-image"><br/>
                <label>Normal Chai (₹15):
                    <input type="number" id="normalChaiQty" value="0" min="0"/>
                </label><br><br>
                <img src="image/image/kullad-tea.png" alt="Tandoori Chai Image" class="product-image"><br/>
                <label>Tandoori Chai (₹30):
                    <input type="number" id="tandooriChaiQty" value="0" min="0"/>
                </label><br><br>
                <img src="image/image/black-tea.png" alt="Black Tea Image" class="product-image"><br/>
                <label>Black Tea (₹30):
                    <input type="number" id="blackTeaQty" value="0" min="0"/>
                </label>

                <div class="product-feedback-container">
                    <div class="feedback-form-area">
                        <h2 style="text-align:center;">Rate Tea</h2>
                        <label for="teaRating">Rating:</label>
                        <select id="teaRating" name="tea_rating">
                            <option value="">--Rate--</option>
                            <option value="5">⭐⭐⭐⭐⭐ (5)</option>
                            <option value="4">⭐⭐⭐⭐ (4)</option>
                            <option value="3">⭐⭐⭐ (3)</option>
                            <option value="2">⭐⭐ (2)</option>
                            <option value="1">⭐ (1)</option>
                        </select><br><br>
                        <label for="teaComment">Your Feedback:</label><br>
                        <textarea id="teaComment" name="tea_comment" rows="3" placeholder="Write your comment here..."></textarea>
                        <br><br>
                        <button type="button" class="btn" onclick="submitFeedback('Tea', 'teaRating', 'teaComment', 'teaFeedbackDisplay')">Submit Feedback</button>
                    </div>
                    <div class="feedback-display-area">
                        <h3>Tea Feedback</h3>
                        <ul id="teaFeedbackDisplay"></ul>
                    </div>
                </div>
            </fieldset>

            <br>
            <h3>Total Price: ₹<span id="total">0.00</span></h3>
            <div class="order-action-buttons">
                <button type="button" class="btn" onclick="calculateTotal()">Calculate Total</button>
                <button type="submit" class="btn">Proceed to Order Summary</button>
            </div>
        </form>
    </section>

    <script>
        // --- Helper function to get selected radio button value ---
        function getCheckedRadioValue(name) {
            const radios = document.getElementsByName(name);
            for (let i = 0; i < radios.length; i++) {
                if (radios[i].checked) {
                    return radios[i].value;
                }
            }
            return null; // No radio button checked
        }

        // --- Feedback Submission Function ---
        function submitFeedback(productName, ratingId, commentId, displayListId) {
            const rating = document.getElementById(ratingId).value;
            const comment = document.getElementById(commentId).value;
            const feedbackList = document.getElementById(displayListId);

            if (!rating && !comment.trim()) {
                alert('Please select a rating or enter a comment.');
                return;
            }

            const newFeedback = document.createElement("li");
            newFeedback.innerHTML = `<strong>${productName}</strong> - ${rating ? "⭐".repeat(parseInt(rating)) : 'No Rating'}<br><em>${comment.trim() || 'No comment provided.'}</em>`;
            feedbackList.appendChild(newFeedback);

            // Clear the form fields for this specific product's feedback
            document.getElementById(ratingId).value = '';
            document.getElementById(commentId).value = '';
            alert(`Feedback for ${productName} submitted!`);
        }

        // --- Main Order Calculation & Storage Function ---
        function calculateTotal() {
            let subTotal = 0;
            const orderedItems = []; // Array to store details of each ordered item

            // --- Hookah ---
            const hookahFlavourSelect = document.getElementById("hookahFlavour");
            const hookahFlavour = hookahFlavourSelect.value;
            const hookahBasePrice = 400; // Base price for any selected hookah flavor
            let currentHookahTotal = 0;

            if (hookahFlavour !== "None") {
                currentHookahTotal += hookahBasePrice;
                orderedItems.push({ name: `Hookah (${hookahFlavour})`, price: hookahBasePrice, qty: 1 });
            }

            const extraHookah = document.getElementById("hookahExtra").checked;
            if (extraHookah) {
                currentHookahTotal += 50;
                orderedItems.push({ name: "Hookah Extra Coal & Paper", price: 50, qty: 1 });
            }

            const extraHours = parseInt(document.getElementById("extraHookahHours").value || 0);
            if (extraHours > 0) {
                const extraHoursCost = extraHours * 100;
                currentHookahTotal += extraHoursCost;
                orderedItems.push({ name: `Hookah Extra Hours (${extraHours} hrs)`, price: extraHoursCost, qty: 1 });
            }
            subTotal += currentHookahTotal; // Add calculated hookah price to total


            // --- Simple Momo ---
            const simpleMomoQty = parseInt(document.getElementById("simpleMomoQty").value || 0);
            const simpleMomoSize = getCheckedRadioValue('simple_momo_size');
            if (simpleMomoQty > 0 && simpleMomoSize) {
                const momoPricePerPlate = simpleMomoSize === "half" ? 60 : 120;
                const itemTotal = momoPricePerPlate * simpleMomoQty;
                subTotal += itemTotal;
                orderedItems.push({ name: `Simple Momo (${simpleMomoSize})`, price: momoPricePerPlate, qty: simpleMomoQty });
            }

            // --- Jhol Momo ---
            const jholMomoQty = parseInt(document.getElementById("jholMomoQty").value || 0);
            const jholMomoSize = getCheckedRadioValue('jhol_momo_size');
            if (jholMomoQty > 0 && jholMomoSize) {
                const jholPricePerPlate = jholMomoSize === "half" ? 99 : 199;
                const itemTotal = jholPricePerPlate * jholMomoQty;
                subTotal += itemTotal;
                orderedItems.push({ name: `Jhol Momo (${jholMomoSize})`, price: jholPricePerPlate, qty: jholMomoQty });
            }

            // --- Coffee ---
            const englishCoffeeQty = parseInt(document.getElementById("englishCoffeeQty").value || 0);
            if (englishCoffeeQty > 0) {
                subTotal += 80 * englishCoffeeQty;
                orderedItems.push({ name: "English Coffee", price: 80, qty: englishCoffeeQty });
            }
            const plainCoffeeQty = parseInt(document.getElementById("plainCoffeeQty").value || 0); // Corrected ID
            if (plainCoffeeQty > 0) {
                subTotal += 80 * plainCoffeeQty;
                orderedItems.push({ name: "Plain Coffee", price: 80, qty: plainCoffeeQty });
            }

            // --- Noodles ---
            const noodlesQty = parseInt(document.getElementById("noodlesQty").value || 0);
            const noodlesSize = getCheckedRadioValue('noodles_size');
            if (noodlesQty > 0 && noodlesSize) {
                const noodlesPricePerPlate = noodlesSize === "half" ? 80 : 150;
                const itemTotal = noodlesPricePerPlate * noodlesQty;
                subTotal += itemTotal;
                orderedItems.push({ name: `Noodles (${noodlesSize})`, price: noodlesPricePerPlate, qty: noodlesQty });
            }

            // --- Tea ---
            const normalChaiQty = parseInt(document.getElementById("normalChaiQty").value || 0);
            if (normalChaiQty > 0) {
                subTotal += 15 * normalChaiQty;
                orderedItems.push({ name: "Normal Chai", price: 15, qty: normalChaiQty });
            }
            const tandooriChaiQty = parseInt(document.getElementById("tandooriChaiQty").value || 0);
            if (tandooriChaiQty > 0) {
                subTotal += 30 * tandooriChaiQty;
                orderedItems.push({ name: "Tandoori Chai", price: 30, qty: tandooriChaiQty });
            }
            const blackTeaQty = parseInt(document.getElementById("blackTeaQty").value || 0);
            if (blackTeaQty > 0) {
                subTotal += 30 * blackTeaQty;
                orderedItems.push({ name: "Black Tea", price: 30, qty: blackTeaQty });
            }

            // Display Total on this page
            document.getElementById("total").textContent = subTotal.toFixed(2);

            // Store order details in localStorage for the order-summary page
            localStorage.setItem('orderDetails', JSON.stringify({
                items: orderedItems,
                subTotal: subTotal.toFixed(2)
            }));

            console.log("Order details stored:", orderedItems, "Subtotal:", subTotal);
        }

        // Event listener for the form submission
        document.getElementById("mainOrderForm").addEventListener("submit", function(event) {
            event.preventDefault(); // Prevent default form submission to manually handle redirection after storing data

            // Ensure the latest total and items are stored before redirecting
            calculateTotal();

            // Redirect to the order summary page
            window.location.href = this.action; // Redirects to 'order-summary.html' as defined in form action
        });

        // JavaScript for Hamburger Menu - Place this right before </body>
        document.addEventListener('DOMContentLoaded', function() {
            const menuToggle = document.querySelector('.menu-toggle');
            const navbarNav = document.querySelector('.navbar-nav');

            menuToggle.addEventListener('click', function() {
                navbarNav.classList.toggle('show');
                menuToggle.classList.toggle('open'); // For the icon animation
                document.body.classList.toggle('no-scroll', navbarNav.classList.contains('show'));
            });

            navbarNav.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    navbarNav.classList.remove('show');
                    menuToggle.classList.remove('open');
                    document.body.classList.remove('no-scroll');
                });
            });
        });
    </script>
</body>
</html>
